# Cocos Creator CSV 座標匯入擴展

## 📋 工具簡介

將 PS 匯出的 CSV 座標檔案匯入 Cocos Creator，自動建立/更新節點並設定 Sprite 圖片。

### 功能特色
- ✅ 自動建立節點結構
- ✅ 更新現有節點座標
- ✅ 匯入圖片並設定 Sprite
- ✅ 保留群組層級結構
- ✅ Size Mode 自動設為 RAW

---

## 📦 安裝步驟

### Step 1：下載擴展

下載 `csv-position-importer.zip`

### Step 2：解壓縮到專案

```
你的專案/
└── extensions/
    └── csv-position-importer/    ← 解壓縮到這裡
        ├── dist/
        │   └── main.js
        └── package.json
```

### Step 3：重新載入擴展

在 Cocos Creator 中：
```
擴展 → 擴展管理器 → 重新載入
```

或重新啟動 Cocos Creator

### Step 4：確認安裝成功

```
工具 → CSV 座標匯入 → 匯入 CSV 座標...
```

看到選項表示安裝成功！

---

## 🎯 使用流程

### Step 1：開啟場景

確保已開啟要匯入的場景，且場景中有 Canvas 節點

### Step 2：執行匯入

```
工具 → CSV 座標匯入 → 匯入 CSV 座標...
```

### Step 3：選擇 CSV 檔案

選擇 PS 匯出的 `positions.csv`

### Step 4：選擇匯入模式

```
┌─────────────────────────────────────────────────────┐
│  匯入 CSV 座標                                       │
├─────────────────────────────────────────────────────┤
│  CSV 檔案：positions.csv                             │
│  ✓ 偵測到 images 資料夾                              │
│                                                     │
│  請選擇匯入模式：                                     │
│                                                     │
│  [取消] [更新節點 + 圖片] [僅更新節點]                │
└─────────────────────────────────────────────────────┘
```

### Step 5：選擇圖片資料夾（如選擇「更新節點 + 圖片」）

1. 選擇**圖片來源資料夾**（PS 匯出的 images 資料夾）
2. 選擇**匯入目標資料夾**（專案 assets 內的資料夾）

### Step 6：確認並匯入

```
┌─────────────────────────────────────┐
│  確認匯入                            │
├─────────────────────────────────────┤
│  即將執行：                          │
│                                     │
│  • CSV: positions.csv               │
│  • 模式: 更新節點 + 圖片             │
│  • 圖片來源: images/                 │
│  • 匯入目標: /textures/ui           │
│                                     │
│  [取消] [開始匯入]                   │
└─────────────────────────────────────┘
```

### Step 7：完成

```
┌─────────────────────────────────────┐
│  匯入完成                            │
├─────────────────────────────────────┤
│  ✓ 更新 5 個節點                     │
│  ✓ 建立 10 個新節點                  │
│  ✓ 設定 12 個 Sprite                 │
│  ✓ 匯入 12 張圖片                    │
│                                     │
│  ⚠️ 請記得儲存場景！                  │
│                                     │
│  [確定]                              │
└─────────────────────────────────────┘
```

---

## ⚙️ 匯入模式說明

### 更新節點 + 圖片

完整功能：

| 步驟 | 動作 |
|------|------|
| 1 | 讀取 CSV 座標資料 |
| 2 | 複製圖片到專案 assets |
| 3 | 找不到的節點 → 自動建立 |
| 4 | 已存在的節點 → 更新座標 |
| 5 | 為節點添加 Sprite 組件 |
| 6 | 設定 SpriteFrame |
| 7 | Size Mode 設為 RAW |

**適用場景：**
- 首次匯入 UI
- 位置和圖片都有更新

### 僅更新節點

只處理節點座標，不處理圖片

| 步驟 | 動作 |
|------|------|
| 1 | 讀取 CSV 座標資料 |
| 2 | 找不到的節點 → 自動建立 |
| 3 | 已存在的節點 → 更新座標 |

**適用場景：**
- 只調整了 UI 位置
- 圖片已經在專案中
- 不想重新匯入圖片

---

## 📁 檔案結構要求

### CSV 檔案格式

匯入的 CSV 需要包含以下欄位：

```csv
圖層名稱,類型,路徑,PS_X,PS_Y,寬度,高度,Cocos_X,Cocos_Y
bg_main,layer,Background,0,0,1280,585,0,0
btn_start,layer,UI_Panel,100,200,200,80,-540,92
```

必要欄位：
- `圖層名稱` - 節點名稱
- `Cocos_X` / `Cocos_Y` - 座標
- `寬度` / `高度` - 尺寸（用於 UITransform）

可選欄位：
- `類型` - layer 或 group
- `路徑` - 父節點路徑

### 圖片資料夾結構

```
images/
├── btn_start.png        ← 圖片名稱需與 CSV 中的圖層名稱相同
├── btn_settings.png
├── UI_Panel/            ← 支援子資料夾
│   └── icon_logo.png
└── Background/
    └── bg_main.png
```

> 💡 圖片名稱（不含副檔名）需與 CSV 中的「圖層名稱」完全相同

---

## 🔧 節點處理邏輯

### 新建節點

當場景中找不到同名節點時：

1. 在 Canvas 下建立新節點
2. 設定節點名稱
3. 設定位置 (x, y)
4. 添加 UITransform 組件
5. 設定 ContentSize
6. 如有圖片，添加 Sprite 組件並設定

### 更新節點

當場景中已有同名節點時：

1. 更新位置 (x, y)
2. 如有圖片，更新或添加 Sprite 組件

### 群組處理

CSV 中 `類型` 為 `group` 的項目：

1. 建立空節點作為容器
2. 子節點根據 `路徑` 欄位放入對應群組

---

## ⚠️ 注意事項

### 節點命名

- 節點名稱來自 CSV 的「圖層名稱」
- 場景中如有同名節點，會更新該節點
- 建議使用唯一的命名

### 圖片資源

- 圖片會複製到指定的 assets 資料夾
- 已存在的同名圖片會被覆蓋
- 匯入後需等待資源刷新完成

### 儲存場景

- 匯入完成後**務必儲存場景**
- 否則所有變更會遺失

---

## ❓ 常見問題

### Q: 節點有 Sprite 組件但沒有圖片？
A: 可能原因：
1. 圖片名稱與圖層名稱不符
2. 資源尚未刷新完成，請稍等幾秒後檢查
3. 圖片不在選擇的來源資料夾中

### Q: 座標不對？
A: 請確認：
1. PS 腳本中的畫布尺寸與 Cocos 專案一致
2. PS 腳本中的錨點設定正確
3. Cocos 節點的錨點為 (0.5, 0.5)

### Q: 找不到節點被建立在哪裡？
A: 新建的節點會放在 Canvas 下。如果 CSV 中有指定路徑，會放在對應的群組節點下。

### Q: 如何重新匯入？
A: 直接再次執行匯入即可：
- 已存在的節點會更新座標
- 不存在的節點會建立

### Q: 圖片匯入到哪裡了？
A: 匯入到你選擇的目標資料夾，預設為 `assets/imported-ui/`

---

## 📞 版本資訊

- **版本**：v6.5
- **適用**：Cocos Creator 3.x

---

*最後更新：2026-02*
